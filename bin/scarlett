#!/bin/bash

# set_mix_volume "$mixerOutputLetter" "$mixerInputNumber" "$volume"
mix_volume() {
  amixer -c 1 sset "Mix $1 Input $2" "$3%"
}

mix_default() {
  
  mainLeftOut="A"
  mainRightOut="B"
  atemLeftOut="C"
  atemRightOut="D"

  # Mic 1 (Analogue Input 01) to headphones and monitors
  mix_volume $mainLeftOut "01" "90"
  mix_volume $atemLeftOut "01" "0"
  mix_volume $mainRightOut "01" "90"
  mix_volume $atemRightOut "01" "0"
  
  # Mic/Ins 2 (Analogue Input 02) default off
  mix_volume $mainLeftOut "02" "0"
  mix_volume $atemLeftOut "02" "0"
  mix_volume $mainRightOut "02" "0"
  mix_volume $atemRightOut "02" "0"
  
  # Pocket Operator (Analogue Input 03 & 04) to headphones and monitors
  ## Analogue Input 03 == Pocket Operator Left Channel
  mix_volume $mainLeftOut "03" "93"
  mix_volume $atemLeftOut "03" "0"
  mix_volume $mainRightOut "03" "0"
  mix_volume $atemRightOut "03" "0"
  ## Analogue Input 04 == Pocket Operator Right Channel
  mix_volume $mainLeftOut "04" "0"
  mix_volume $atemLeftOut "04" "0"
  mix_volume $mainRightOut "04" "93"
  mix_volume $atemRightOut "04" "0"
  
  # Atem Mini Program Output (S/PDIF 01 & 02) to headphones and monitors
  ## S/PDIF 01 == Program Left Channel
  mix_volume $mainLeftOut "05" "0"
  mix_volume $atemLeftOut "05" "0"
  mix_volume $mainRightOut "05" "0"
  mix_volume $atemRightOut "05" "0"
  ## S/PDIF 02 == Program Right Channel
  mix_volume $mainLeftOut "06" "0"
  mix_volume $atemLeftOut "06" "0"
  mix_volume $mainRightOut "06" "0"
  mix_volume $atemRightOut "06" "0"
  
  # Computer Output (PCM 01 & PCM 02) to headphones and monitors
  ## PCM 01 == Computer Left Channel
  mix_volume $mainLeftOut "07" "93"
  mix_volume $atemLeftOut "07" "0"
  mix_volume $mainRightOut "07" "0"
  mix_volume $atemRightOut "07" "0"
  
  ## PCM 02 == Computer Right Channel
  mix_volume $mainLeftOut "08" "0"
  mix_volume $atemLeftOut "08" "0"
  mix_volume $mainRightOut "08" "93"
  mix_volume $atemRightOut "08" "0"
  
}

mix_atem() {

  mainLeftOut="A"
  mainRightOut="B"
  atemLeftOut="C"
  atemRightOut="D"

  # Mic 1 (Analogue Input 01) to Atem Mini
  mix_volume $mainLeftOut "01" "0"
  mix_volume $atemLeftOut "01" "85"
  mix_volume $mainRightOut "01" "0"
  mix_volume $atemRightOut "01" "85"
  
  # Mic/Ins 2 (Analogue Input 02) default off
  mix_volume $mainLeftOut "02" "0"
  mix_volume $atemLeftOut "02" "0"
  mix_volume $mainRightOut "02" "0"
  mix_volume $atemRightOut "02" "0"
  
  # Pocket Operator (Analogue Input 03 & 04) to Atem Mini
  ## Analogue Input 03 == Pocket Operator Left Channel
  mix_volume $mainLeftOut "03" "0"
  mix_volume $atemLeftOut "03" "90"
  mix_volume $mainRightOut "03" "0"
  mix_volume $atemRightOut "03" "0"
  ## Analogue Input 04 == Pocket Operator Right Channel
  mix_volume $mainLeftOut "04" "0"
  mix_volume $atemLeftOut "04" "0"
  mix_volume $mainRightOut "04" "0"
  mix_volume $atemRightOut "04" "90"
  
  # Atem Mini Program Output (S/PDIF 01 & 02) to headphones and monitors
  ## S/PDIF 01 == Program Left Channel
  mix_volume $mainLeftOut "05" "93"
  mix_volume $atemLeftOut "05" "0"
  mix_volume $mainRightOut "05" "0"
  mix_volume $atemRightOut "05" "0"
  ## S/PDIF 02 == Program Right Channel
  mix_volume $mainLeftOut "06" "0"
  mix_volume $atemLeftOut "06" "0"
  mix_volume $mainRightOut "06" "93"
  mix_volume $atemRightOut "06" "0"
  
  # Computer Output (PCM 01 & PCM 02) to headphones and monitors
  ## PCM 01 == Computer Left Channel
  mix_volume $mainLeftOut "07" "93"
  mix_volume $atemLeftOut "07" "0"
  mix_volume $mainRightOut "07" "0"
  mix_volume $atemRightOut "07" "0"
  
  ## PCM 02 == Computer Right Channel
  mix_volume $mainLeftOut "08" "0"
  mix_volume $atemLeftOut "08" "0"
  mix_volume $mainRightOut "08" "93"
  mix_volume $atemRightOut "08" "0"
  
}

main() {
  declare arg="$1"

  if [[ -z "$arg" ]]; then
    mix_default
  elif [[ "$arg" = "atem" ]]; then
    mix_atem
  elif [[ "$arg" = "" ]]; then
    vpn_stop
  elif [[ "$arg" = "status" ]]; then
    vpn_status
  else
    echo "Invalid parameter, use start, stop, or status."
  fi

}
main "$@"

